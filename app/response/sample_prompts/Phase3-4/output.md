了解しました。フェーズ3（HTTPSとSSL/TLS）およびフェーズ4（証明書システム）について、画像や図を活用しつつ、大学院生レベルの読者向けに専門的かつ詳細な解説資料を日本語で作成します。内容は他の信頼できる文献から統合し、丁寧かつ省略のない構成にします。

資料が完成次第、マークダウン形式でご提供しますので、しばらくお待ちください。

## フェーズ3: HTTPSとSSL/TLS

HTTPSは、通信内容を暗号化することでHTTPにセキュリティを付与するプロトコルであり、SSL/TLSによって実現されます ([〖図解で解説〗HTTP、HTTPS、SSL、TLSについて詳しく解説します](https://zenn.dev/mukkun69n/articles/c644342f6a8253#:~:text=%E3%82%AF%E3%83%AC%E3%82%B8%E3%83%83%E3%83%88%E3%82%AB%E3%83%BC%E3%83%89%E7%95%AA%E5%8F%B7%E3%82%92%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%81%8C%E3%80%81SSL%2FTLS%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB%20%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%20%E6%9A%97%E5%8F%B7%E5%8C%96%20%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82%20SSL%EF%BC%88Secure,%E3%81%A8%20TLS%EF%BC%88Transport%20Layer%20Security%EF%BC%89%E3%81%AF%E3%80%81%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%8D%E3%83%83%E3%83%88%E9%80%9A%E4%BF%A1%E3%81%AB%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%82%92%E6%8F%90%E4%BE%9B%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AB%E4%BD%BF%E7%94%A8%E3%81%95%E3%82%8C%E3%82%8B%E6%9A%97%E5%8F%B7%E5%8C%96%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB%20%E3%81%A7%E3%81%99%E3%80%82))。SSL（Secure Sockets Layer）は1990年代にNetscape社が開発した暗号化プロトコルで、いくつかのバージョン（SSL 2.0/3.0）が存在しました。その後1999年にIETFによってTLS（Transport Layer Security）へと名称変更・標準化され、現在ではTLS 1.2およびTLS 1.3が主流となっています ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=TLS%20%E4%B8%8E%20SSL%E6%9F%90%E7%A7%8D%E7%A8%8B%E5%BA%A6%E4%B8%8A%E6%8C%87%E7%9A%84%E6%98%AF%E5%90%8C%E4%B8%80%E4%B8%AA%E6%A6%82%E5%BF%B5%EF%BC%9A))（SSL3.0やTLS1.0は既に非推奨）。HTTPSは「HTTP over TLS」とも呼ばれ、通常TCPポート443上でまずTLSのハンドシェイクを行い、その上でHTTPメッセージを暗号化してやりとりします。TLSの目的は、**通信の機密性**（盗聴防止）と**完全性**（改ざん検知）、そしてサーバの**真正性**（なりすまし防止）の保証です。この真正性の保証にサーバ証明書（後述）が用いられます。

TLSハンドシェイクでは、クライアント（Webブラウザなど）とサーバが暗号化通信を開始するために必要な情報を交換します ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=Internet%20communications,will%20use%2C%20and%20agree%20on))。まずクライアントとサーバ間でTCPのコネクション（三者間ハンドシェイク）が確立された後、TLSハンドシェイクが始まります ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=A%20TLS%20handshake%20takes%20place,A%20TLS))。ハンドシェイク中、通信双方は以下のような事項をすり合わせます ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=,after%20the%20handshake%20is%20complete))：

- 利用する**TLSのバージョン**（例: TLS 1.2 など） ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=1,the%20server%20is%20who%20it))
- 利用する**暗号スイート**（共通鍵暗号やハッシュアルゴリズムの組合せ） ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=1,that%27s%20generated%20by%20the%20server))
- サーバ側の**デジタル証明書**を用いたサーバの認証 ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=server%27s%20chosen%20cipher%20suite%2C%20and,%28The%20client%20gets%20the))
- **セッション鍵**（共通鍵）の生成と交換 ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=,after%20the%20handshake%20is%20complete))

この一連の手順により、以降のアプリケーションデータ（HTTPメッセージ）は共通鍵による暗号化通信で保護されることになります。

 ([File:Full TLS 1.2 Handshake.svg - Wikipedia](https://en.m.wikipedia.org/wiki/File:Full_TLS_1.2_Handshake.svg))TLS 1.2ハンドシェイクのフロー図。クライアント（左）とサーバ（右）が複数回のメッセージのやりとりによってセッション鍵を共有し、暗号化通信路を確立する（青字は初期の平文メッセージ、緑字は鍵共有後の暗号化メッセージ）。

### TLSハンドシェイクの手順

典型的なTLSハンドシェイクの流れを具体的に見てみましょう（ここではTLS 1.2の例） ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=The%20exact%20steps%20within%20a,It%20goes%20roughly%20as%20follows))。まずクライアントが「**ClientHello**」メッセージを送信してハンドシェイクを開始します。ClientHelloにはクライアントの対応可能なTLSバージョンや乱数、サポートする暗号スイートのリスト、圧縮方式の候補、セッションID（セッション再開がある場合）などが含まれます ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=,extensions%EF%BC%9A%E6%89%A9%E5%B1%95%E5%AD%97%E6%AE%B5%EF%BC%9B))。例えばClientHelloの主要なフィールドは以下の通りです ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=,extensions%EF%BC%9A%E6%89%A9%E5%B1%95%E5%AD%97%E6%AE%B5%EF%BC%9B))：

- **Version**: クライアントがサポートするTLS/SSLの最大バージョン（例: TLS1.2 など）  
- **Random**: クライアントが生成したランダム値（`client_random`）。後の鍵交換で使用される ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=,Compression%20Methods%EF%BC%9A%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%94%AF%E6%8C%81%E7%9A%84%E5%8E%8B%E7%BC%A9%E7%AE%97%E6%B3%95%E5%88%97%E8%A1%A8%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%90%8E%E7%BB%AD%E7%9A%84%E4%BF%A1%E6%81%AF%E5%8E%8B%E7%BC%A9%E4%BC%A0%E8%BE%93%EF%BC%9B))  
- **Session ID**: 過去のセッションを再利用するためのID（再開時のみ送信） ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=,extensions%EF%BC%9A%E6%89%A9%E5%B1%95%E5%AD%97%E6%AE%B5%EF%BC%9B))  
- **Cipher Suites**: クライアントがサポートする暗号スイートのリスト（優先順） ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=,extensions%EF%BC%9A%E6%89%A9%E5%B1%95%E5%AD%97%E6%AE%B5%EF%BC%9B))  
- **Compression Methods**: サポートする圧縮方式のリスト ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=,extensions%EF%BC%9A%E6%89%A9%E5%B1%95%E5%AD%97%E6%AE%B5%EF%BC%9B))  
- **Extensions**: 拡張フィールド（サーバ名表示SNIやALPNなど、必要に応じ含まれる）

次にサーバは「**ServerHello**」メッセージを送り、TLSバージョンと暗号スイートを確定します ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=))。ServerHelloにはサーバが選択したプロトコルバージョン、暗号スイート及び圧縮方式、サーバが生成した乱数（`server_random`）などが含まれます ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=Server%20Hello%EF%BC%88%20Server%E2%80%94%E2%80%94,%E7%AD%89%EF%BC%8C%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E6%8A%93%E5%8C%85%E5%A6%82%E4%B8%8B%EF%BC%9A))。これでクライアントとサーバ双方が乱数 (`client_random` と `server_random`) を持ち、暗号アルゴリズムも決定されました ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=,Compression%20Methods%EF%BC%9A%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%80%89%E6%8B%A9%E7%9A%84%E5%8E%8B%E7%BC%A9%E7%AE%97%E6%B3%95%EF%BC%9B))。

続いてサーバは「**Certificate**」メッセージで自分の公開鍵証明書（サーバ証明書）をクライアントに送信します ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=))。証明書には後述するようにサーバの公開鍵や識別情報が含まれており、**認証局のデジタル署名**で保証されています。クライアントはこの証明書を受け取ると、その**有効性（正当な証明書か）**を検証します（検証方法はフェーズ4で詳説） ([SSL 証明書とは? - SSL/TLS 証明書の説明 - AWS](https://aws.amazon.com/jp/what-is/ssl-certificate/#:~:text=4,%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AF%E3%80%81%E7%A7%98%E5%AF%86%E9%8D%B5%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E9%8D%B5%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%E6%AC%A1%E3%81%AB%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%AD%E3%83%BC%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E7%A2%BA%E8%AA%8D%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%AB%E9%80%81%E4%BF%A1%E3%81%97%E3%81%BE%E3%81%99%E3%80%82))。例えばブラウザは証明書の発行者が信頼できる認証局か、証明書が改ざんされていないか、証明書の有効期限が切れていないか、要求したドメイン名と証明書の対象名が一致するか等を確認します ([SSL 証明書とは? - SSL/TLS 証明書の説明 - AWS](https://aws.amazon.com/jp/what-is/ssl-certificate/#:~:text=4,%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AF%E3%80%81%E7%A7%98%E5%AF%86%E9%8D%B5%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E9%8D%B5%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%E6%AC%A1%E3%81%AB%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%AD%E3%83%BC%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E7%A2%BA%E8%AA%8D%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%AB%E9%80%81%E4%BF%A1%E3%81%97%E3%81%BE%E3%81%99%E3%80%82))。証明書の検証に成功すると、クライアントはサーバが真正であると判断しハンドシェイクを続行します。

サーバは必要に応じて鍵交換に関する追加データを送ることもあります（例えばTLS 1.2でECDHE暗号スイートを用いる場合の「Server Key Exchange」メッセージなど）。またクライアント証明書認証が要求される場合、サーバは「CertificateRequest」メッセージを送り、クライアントから自身の証明書を提示させることもあります ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=server%27s%20chosen%20cipher%20suite%2C%20and,%28The%20client%20gets%20the))（一般的なHTTPSでは省略されることが多い）。その後サーバから「ServerHelloDone」で一連のサーバ側のハンドシェイクメッセージが完了したことが通知されます。

次にクライアント側から、共有鍵の交換や生成を行う段階に入ります。クライアントは「**Client Key Exchange**」メッセージを送信し、セッション鍵の材料となるプレマスターシークレット（Pre-Master Secret）をサーバに共有します。具体的には、RSA暗号を用いる場合クライアントはサーバ証明書の公開鍵でプレマスターシークレットを暗号化して送ります ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=4,message%20that%20is%20encrypted))（これによりプレマスターシークレットはサーバの秘密鍵でしか復号できません）。一方、(EC)DHEなどの**ディフィー・ヘルマン鍵交換**の場合はクライアントの公開値を送信し、サーバとの間で暗号学的に安全な共有秘密を生成します ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=All%20TLS%20handshakes%20make%20use,Hellman%20handshake%20proceeds%20as%20follows))。サーバはRSAの場合は秘密鍵でプレマスターシークレットを復号し、DHEの場合は受け取った公開値から共有秘密を計算します ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=4,message%20that%20is%20encrypted))。

こうして得られたプレマスターシークレットと先ほどの双方の乱数 (`client_random` + `server_random`) から、クライアントとサーバは共通の**マスターシークレット**を計算します。TLS 1.2ではPRF（疑似乱数関数）を用いてこれらを組み合わせセッション鍵素材を生成し、対称暗号で使う共通鍵やHMAC用の鍵などを導出します ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=5,The%20handshake%20is%20completed%2C%20and))。クライアントとサーバは独立に同じ計算を行いますが、双方で結果が一致するはずです ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=5,The%20handshake%20is%20completed%2C%20and))。以降の通信ではこの共通鍵にもとづく暗号アルゴリズム（例えばAES-GCMなど選択された方式）でデータを暗号化し、HMACやAEADにより改ざん検知が付加されます。

セッション鍵の共有が完了すると、クライアントから「**ChangeCipherSpec**」と「**Finished**」メッセージが送信されます。ChangeCipherSpecは「これ以降の通信はネゴシエートした共通鍵と暗号方式で暗号化する」ことを通知するプロトコルで、続くFinishedメッセージから実際に暗号化が適用されます ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=,%E5%8A%A0%E5%AF%86%E3%80%82))。Finishedメッセージはハンドシェイク全体の検証用データを共通鍵でMAC付与したもので、暗号化通信の最初のデータです。続いてサーバもChangeCipherSpecとFinishedメッセージを送り、ハンドシェイクが終了します ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=,%E5%8A%A0%E5%AF%86%E3%80%82))。以上で安全な通信路（TLSセッション）が確立され、以降はHTTPのリクエスト/レスポンスなど実際のアプリケーションデータが**Application Data**として暗号化されて流れます ([一文详解 HTTPS 与 TLS证书链校验_证书链怎么验证-CSDN博客](https://blog.csdn.net/liuxiao723846/article/details/127739868#:~:text=,%E5%8A%A0%E5%AF%86%E3%80%82))。

ハンドシェイクの完了後、ブラウザのアドレスバーには錠前アイコンが表示され、HTTPS通信が行われていることが示されます。仮に証明書の検証に失敗した場合（例：不正な自己署名証明書やドメイン不一致など）は、ブラウザは警告を表示してユーザに通知し、通信を中断またはユーザ承諾待ちとします。正常に確立されたHTTPS接続では、攻撃者が途中で通信を傍受・改ざんすることは極めて困難です。こうしてユーザは、安全な経路でWebサーバとの機密通信を行うことができます。

**＊メモ：TLS 1.3の主な変更点** – 上記はTLS 1.2までの従来型ハンドシェイクの説明ですが、TLS 1.3では暗号スイートの簡素化と0-RTTハンドシェイクの導入など大きな改良が加えられています。TLS 1.3ではRSAによる鍵交換が廃止され、必ず(PFSを備えた)楕円曲線ディフィー・ヘルマンなどの方式で共有鍵を生成します。またサーバ証明書や認証関連以外の初期メッセージは暗号化され、往復回数も削減されています ([〖実践編〗HTTPS通信の中身を見て、どのようにしてセキュアな通信が確立されるかを理解する | フューチャー技術ブログ](https://future-architect.github.io/articles/20250325a/#:~:text=TLS1))。これによりTLS 1.3はTLS 1.2に比べセキュリティと性能が向上しています。ただし基本的な信頼の構築（証明書によるサーバ認証と共通鍵合意）という点はTLS 1.2以前と変わりません。

## フェーズ4: 証明書システム

TLSによるサーバ認証の要となるのが**デジタル証明書**の仕組みです。証明書とは公開鍵に所有者情報を結びつけて、その対応関係を保証する電子的な証明書データです。Webサーバの場合、いわゆる「SSLサーバ証明書」と呼ばれるX.509形式の証明書が用いられます。TLSハンドシェイクではサーバが自分の公開鍵証明書を提示し、クライアント（ブラウザ）がそれを検証することで「その公開鍵が本当にアクセス先サーバのものか」確認します ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=%E6%88%91%E4%BB%AC%E5%85%88%E6%9D%A5%E7%9C%8B%E8%AF%81%E4%B9%A6%EF%BC%8C%E8%AF%81%E4%B9%A6%E6%98%AF%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%EF%BC%8C%E9%87%8C%E9%9D%A2%E5%90%AB%E6%9C%89%E7%9B%AE%E6%A0%87%E7%BD%91%E7%AB%99%E7%9A%84%E5%90%84%E7%A7%8D%E4%BF%A1%E6%81%AF%E3%80%82)) ([SSL 証明書とは? - SSL/TLS 証明書の説明 - AWS](https://aws.amazon.com/jp/what-is/ssl-certificate/#:~:text=4,%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AF%E3%80%81%E7%A7%98%E5%AF%86%E9%8D%B5%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E9%8D%B5%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%E6%AC%A1%E3%81%AB%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%AD%E3%83%BC%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E7%A2%BA%E8%AA%8D%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%AB%E9%80%81%E4%BF%A1%E3%81%97%E3%81%BE%E3%81%99%E3%80%82))。ここでは証明書の構造と、証明書を通じた認証システム（公開鍵基盤: PKI）の詳細について解説します。

### X.509証明書の構造

TLSで使われるサーバ証明書はITU-T勧告X.509に基づいた構造を持つデータです ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=))。証明書には主に以下のような情報が含まれます。

- **公開鍵 (Public Key)**: サーバの公開鍵情報（後続の共通鍵交換で使用される）  
- **サブジェクト (Subject)**: 証明書の所有者識別情報（Webサーバの場合はドメイン名や組織名など）  
- **発行者 (Issuer)**: 証明書を発行した認証局（CA）の識別情報  
- **有効期間 (Validity)**: 証明書の有効な期間（開始日と失効日）  
- **拡張領域 (Extensions)**: 用途制限やサブジェクト代替名(SAN)など追加情報（例：SSLサーバ証明書であることを示すExtended Key Usageフィールド等）  
- **デジタル署名 (Digital Signature)**: 発行者（上位CA）がこの証明書に対して行った電子署名値

証明書の本体（公開鍵やサブジェクトなどの情報部）に発行者が電子署名を施すことで、証明書の改ざん検知と発行者認証が可能となっています ([信頼チェーンとは #SSL証明書 - Qiita](https://qiita.com/ikiat4/items/1292608ddf5f4bbc7f0a#:~:text=%E4%B8%8A%E8%A8%98%E3%81%8C%E3%80%81%E3%82%B5%E3%83%BC%E3%83%90%E8%A8%BC%E6%98%8E%E6%9B%B8%28qiita,%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE%E3%81%A7%E3%81%99%E3%80%82%20B%E3%81%95%E3%82%93%E3%81%AE%E5%85%AC%E9%96%8B%E9%8D%B5%E3%81%A7%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%81%A8C%E3%81%95%E3%82%93%E3%81%AE%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%AF%94%E8%BC%83%E3%81%97%E3%81%A6%E6%AD%A3%E5%BD%93%E6%80%A7%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%82%92%E8%A1%8C%E3%81%84%E3%81%BE%E3%81%99%E3%80%82))。電子署名とは「情報のハッシュ値を発行者の秘密鍵で暗号化したもの」であり、対応する公開鍵で復号することで元のハッシュ値と比較できるようにしたものです ([信頼チェーンとは #SSL証明書 - Qiita](https://qiita.com/ikiat4/items/1292608ddf5f4bbc7f0a#:~:text=%E4%B8%8A%E8%A8%98%E3%81%8C%E3%80%81%E3%82%B5%E3%83%BC%E3%83%90%E8%A8%BC%E6%98%8E%E6%9B%B8%28qiita,%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE%E3%81%A7%E3%81%99%E3%80%82%20B%E3%81%95%E3%82%93%E3%81%AE%E5%85%AC%E9%96%8B%E9%8D%B5%E3%81%A7%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%81%A8C%E3%81%95%E3%82%93%E3%81%AE%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%AF%94%E8%BC%83%E3%81%97%E3%81%A6%E6%AD%A3%E5%BD%93%E6%80%A7%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%82%92%E8%A1%8C%E3%81%84%E3%81%BE%E3%81%99%E3%80%82))。たとえばサーバ証明書では、発行者であるCAがその秘密鍵で証明書内容のハッシュを暗号化（署名）し、その署名値が証明書に格納されています。この署名は後述する**証明書チェーン**の検証で使われます。

証明書は一般にバイナリDER形式やテキストPEM形式（Base64エンコード）でファイルに格納・配布されます ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%8F%AB%E5%81%9A%20X,PEM%EF%BC%8C%E6%98%AF%E5%9F%BA%E4%BA%8E%20Base64%20%E7%9A%84%E3%80%82))。Webサーバの証明書はApacheやNginxの設定で秘密鍵と対になって設置され、TLSハンドシェイク時にサーバが提示します。一方ブラウザやOSには**ルート証明書ストア**と呼ばれる信頼済みの認証局証明書のリストが組み込まれており、ここに登録されたCAが発行した証明書であれば信頼する、というモデルになっています ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=%E9%A6%96%E5%85%88%EF%BC%8C%E6%9C%89%E4%B8%80%E6%89%B9%E8%AF%81%E4%B9%A6%E9%A2%81%E5%8F%91%E6%9C%BA%E6%9E%84%EF%BC%88Certificate%20Authority%EF%BC%8C%E7%AE%80%E7%A7%B0%E4%B8%BA%20CA%EF%BC%89%EF%BC%8C%E7%94%B1%E4%BB%96%E4%BB%AC%E7%94%9F%E6%88%90%E7%A7%98%E9%92%A5%E5%AF%B9%EF%BC%8C%E5%85%B6%E4%B8%AD%E7%A7%81%E9%92%A5%E4%BF%9D%E5%AD%98%E5%A5%BD%EF%BC%8C%E5%85%AC%E9%92%A5%E4%BB%A5%E8%AF%81%E4%B9%A6%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%AE%89%E8%A3%85%E5%9C%A8%E6%88%91%E4%BB%AC%E7%9A%84%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B8%AD%EF%BC%8C%E8%BF%99%E5%B0%B1%E6%98%AF%20%E6%A0%B9%E8%AF%81%E4%B9%A6%E3%80%82))。

### 証明書チェーンと信頼の連鎖

クライアントがサーバ証明書を検証する際、単一の証明書だけで完結するわけではありません。現実のPKIでは複数の認証局証明書を階層的に用いる**証明書チェーン（Chain of Trust）**が構築されています ([信頼チェーンとは #SSL証明書 - Qiita](https://qiita.com/ikiat4/items/1292608ddf5f4bbc7f0a#:~:text=%3E%20%20https%3A%2F%2Fwww.gleas.jp%2Fnews%2Fcolumn%2Fcertificate,%E4%BE%8B%E3%81%88%E3%81%B0%E3%80%81%E3%82%B5%E3%83%BC%E3%83%90%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%8C%E8%A8%AD%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8BWeb%E3%82%B5%E3%83%BC%E3%83%90%E3%81%AB%E3%80%81%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%A7%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%99%E3%82%8B%E3%81%A8%E3%80%81%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%AF%E3%82%B5%E3%83%BC%E3%83%90%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E6%AD%A3%E5%BD%93%E6%80%A7%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%E3%81%9D%E3%81%AE%E6%AD%A3%E5%BD%93%E6%80%A7%E7%A2%BA%E8%AA%8D%E3%81%AB%E4%BD%BF%E3%82%8F%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%8C%E8%A8%BC%E6%98%8E%20%E6%9B%B8%E3%83%81%E3%82%A7%E3%83%BC%E3%83%B3%E3%81%A7%E3%81%99%E3%80%82%E6%9C%AC%E7%A8%BF%E3%81%A7%E3%81%AF%E3%81%9D%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF%E3%82%92%E8%A7%A3%E8%AA%AC%E3%81%97%E3%81%BE%E3%81%99%E3%80%82))。これは「ある証明書が上位の証明書によって署名され、その上位証明書はさらにその上位によって署名され…最終的に信頼の起点（ルートCA）に辿り着く」という**信頼の連鎖**です ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=%E6%8E%A5%E4%B8%8B%E6%9D%A5%EF%BC%8C%E5%8F%AA%E8%A6%81%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E4%BD%93%E7%B3%BB%EF%BC%8C%E8%83%BD%E5%A4%9F%E8%AF%81%E6%98%8E%20A%20%E8%AF%81%E4%B9%A6%E7%AD%BE%E5%8F%91%E4%BA%86%20B%20%E8%AF%81%E4%B9%A6%E5%8D%B3%E5%8F%AF%E3%80%82%E8%BF%99%E6%A0%B7%E5%AF%B9%E4%BA%8E%E6%94%B6%E5%88%B0%E7%9A%84%E4%BB%BB%E4%BD%95%E4%B8%80%E4%B8%AA%E8%AF%81%E4%B9%A6%EF%BC%8C%E9%A1%BA%E8%97%A4%E6%91%B8%E7%93%9C%EF%BC%8C%E5%8F%AA%E8%A6%81%E6%9C%80%E4%B8%8A%E9%9D%A2%E7%9A%84%E6%A0%B9%E8%AF%81%E4%B9%A6%E5%9C%A8%E7%B3%BB%E7%BB%9F%E4%B8%AD%E5%AD%98%E5%9C%A8%EF%BC%8C%E5%8D%B3%E5%8F%AF%E8%AF%81%E6%98%8E%E8%AF%A5%E8%AF%81%E4%B9%A6%E6%9C%89%E6%95%88%E3%80%82))。この連鎖を検証することで、最終的に信頼できるルートCAによって間接的に保証された証明書であると確認できます。

具体的には、サーバが提示する証明書（エンドエンティティ証明書）は多くの場合、それ自体が上位の**中間認証局（Intermediate CA）**によって署名されています。中間CA証明書はさらに別の上位CA、最終的には**ルート認証局（Root CA）**によって署名されています ([What is Certificate chain? And how to validate Certificate chain | by Shanaka Sandanayaka | Medium](https://shagihan.medium.com/what-is-certificate-chain-and-how-to-verify-them-be429a030887#:~:text=And%20if%20we%20check%20the,according%20to%20the%20common%20name))。ルートCA証明書は自己署名（自らの秘密鍵で自らに署名）された特別な証明書で、OSやブラウザにあらかじめ信頼済みとして登録されています ([What is Certificate chain? And how to validate Certificate chain | by Shanaka Sandanayaka | Medium](https://shagihan.medium.com/what-is-certificate-chain-and-how-to-verify-them-be429a030887#:~:text=And%20when%20we%20check%20the,and%20the%20OS%20trust%20stores))。したがって、クライアント（ブラウザ）はサーバ証明書からその発行者を辿っていき、信頼ストア内のルートCAに行き着けば「信頼できる発行者によって認証された証明書だ」と判断するわけです ([What is Certificate chain? And how to validate Certificate chain | by Shanaka Sandanayaka | Medium](https://shagihan.medium.com/what-is-certificate-chain-and-how-to-verify-them-be429a030887#:~:text=,CA%20in%20the%20previous%20step))。

 ([How Certificate Chains Work](https://knowledge.digicert.com/solution/how-certificate-chains-work))証明書チェーンの概念図。サーバ（エンドエンティティ）証明書（左）は中間CA証明書（中央）によって署名されており、中間CA証明書はルートCA証明書（右）によって署名されている ([What is Certificate chain? And how to validate Certificate chain | by Shanaka Sandanayaka | Medium](https://shagihan.medium.com/what-is-certificate-chain-and-how-to-verify-them-be429a030887#:~:text=And%20if%20we%20check%20the,according%20to%20the%20common%20name))。検証者（ブラウザ）は各証明書の署名を上位証明書の公開鍵で検証し ([信頼チェーンとは #SSL証明書 - Qiita](https://qiita.com/ikiat4/items/1292608ddf5f4bbc7f0a#:~:text=%E4%B8%8A%E8%A8%98%E3%81%8C%E3%80%81%E3%82%B5%E3%83%BC%E3%83%90%E8%A8%BC%E6%98%8E%E6%9B%B8%28qiita,%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE%E3%81%A7%E3%81%99%E3%80%82%20B%E3%81%95%E3%82%93%E3%81%AE%E5%85%AC%E9%96%8B%E9%8D%B5%E3%81%A7%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%81%A8C%E3%81%95%E3%82%93%E3%81%AE%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%AF%94%E8%BC%83%E3%81%97%E3%81%A6%E6%AD%A3%E5%BD%93%E6%80%A7%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%82%92%E8%A1%8C%E3%81%84%E3%81%BE%E3%81%99%E3%80%82))、最上位が信頼できるルートCAであればサーバ証明書を信頼する。

**検証手順の詳細**: ブラウザがサーバ証明書を受け取ると、まずその署名を検証します。サーバ証明書に付与された署名は「発行者（中間CA）の秘密鍵」で暗号化されたハッシュ値です ([信頼チェーンとは #SSL証明書 - Qiita](https://qiita.com/ikiat4/items/1292608ddf5f4bbc7f0a#:~:text=%E4%B8%8A%E8%A8%98%E3%81%8C%E3%80%81%E3%82%B5%E3%83%BC%E3%83%90%E8%A8%BC%E6%98%8E%E6%9B%B8%28qiita,%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE%E3%81%A7%E3%81%99%E3%80%82%20B%E3%81%95%E3%82%93%E3%81%AE%E5%85%AC%E9%96%8B%E9%8D%B5%E3%81%A7%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%81%A8C%E3%81%95%E3%82%93%E3%81%AE%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%AF%94%E8%BC%83%E3%81%97%E3%81%A6%E6%AD%A3%E5%BD%93%E6%80%A7%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%82%92%E8%A1%8C%E3%81%84%E3%81%BE%E3%81%99%E3%80%82))。ブラウザは発行者である中間CAの証明書に格納された公開鍵でサーバ証明書の署名を復号し、そこから得られるハッシュ値とサーバ証明書の内容から自前で計算したハッシュ値を比較します ([信頼チェーンとは #SSL証明書 - Qiita](https://qiita.com/ikiat4/items/1292608ddf5f4bbc7f0a#:~:text=%E4%B8%8A%E8%A8%98%E3%81%8C%E3%80%81%E3%82%B5%E3%83%BC%E3%83%90%E8%A8%BC%E6%98%8E%E6%9B%B8%28qiita,%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE%E3%81%A7%E3%81%99%E3%80%82%20B%E3%81%95%E3%82%93%E3%81%AE%E5%85%AC%E9%96%8B%E9%8D%B5%E3%81%A7%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%81%A8C%E3%81%95%E3%82%93%E3%81%AE%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%AF%94%E8%BC%83%E3%81%97%E3%81%A6%E6%AD%A3%E5%BD%93%E6%80%A7%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%82%92%E8%A1%8C%E3%81%84%E3%81%BE%E3%81%99%E3%80%82))。両者が一致すれば、そのサーバ証明書は中間CAによって確かに発行（署名）されたものだと分かります ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=A%20%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B7%B1%E7%9A%84%E7%A7%81%E9%92%A5%E7%BB%99%20B%20%E7%94%9F%E6%88%90%E7%AD%BE%E5%90%8D%E7%9A%84%E8%BF%87%E7%A8%8B%E4%B9%9F%E5%B0%B1%E6%98%AF%E3%80%8C%E7%AD%BE%E5%8F%91%E8%AF%81%E4%B9%A6%E3%80%8D%EF%BC%8C%E5%85%B6%E4%B8%AD%20A,%E5%8F%AB%E5%81%9A%20Issuer%EF%BC%8CB%20%E5%8F%AB%E5%81%9A%20Subject%E3%80%82))。次にブラウザは中間CA証明書について同様に、それを署名した上位CA（例えばルートCA）の公開鍵で署名を確認します ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=%E8%BF%99%E6%A0%B7%EF%BC%8C%E5%BD%93%E6%88%91%E4%BB%AC%E6%94%B6%E5%88%B0%20B%20%E8%AF%81%E4%B9%A6%E6%97%B6%EF%BC%8C%E9%A6%96%E5%85%88%E4%BD%BF%E7%94%A8%20A%20%E8%AF%81%E4%B9%A6%E7%9A%84%E5%85%AC%E9%92%A5%EF%BC%88%E5%85%AC%E9%92%A5%E5%AD%98%E5%82%A8%E5%9C%A8%E8%AF%81%E4%B9%A6%E4%B8%AD%EF%BC%89%E8%A7%A3%E5%BC%80%E7%AD%BE%E5%90%8D%E8%8E%B7%E5%BE%97,%E5%8C%B9%E9%85%8D%EF%BC%8C%E8%AF%B4%E6%98%8E%20B%20%E7%A1%AE%E5%AE%9E%E6%98%AF%E7%94%B1%20A%20%E7%AD%BE%E5%8F%91%E7%9A%84%E3%80%82))。このようにしてチェーンを一段ずつ遡り、最後にルートCA証明書の自己署名を確認します。ルートCA証明書は信頼ストアに直接格納されているため追加の検証は不要で、これで一連の証明書の検証が完了します ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=A%20%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B7%B1%E7%9A%84%E7%A7%81%E9%92%A5%E7%BB%99%20B%20%E7%94%9F%E6%88%90%E7%AD%BE%E5%90%8D%E7%9A%84%E8%BF%87%E7%A8%8B%E4%B9%9F%E5%B0%B1%E6%98%AF%E3%80%8C%E7%AD%BE%E5%8F%91%E8%AF%81%E4%B9%A6%E3%80%8D%EF%BC%8C%E5%85%B6%E4%B8%AD%20A,%E5%8F%AB%E5%81%9A%20Issuer%EF%BC%8CB%20%E5%8F%AB%E5%81%9A%20Subject%E3%80%82))。

以上のプロセスにより、ブラウザは「提示されたサーバ証明書は信頼できる認証局によって発行された正当なものである」ことを確認します。加えてブラウザは証明書の**有効期間**をチェックし（現在時刻が有効範囲内か）、**失効状態**も確認します。失効とは、一度発行された証明書が何らかの事情（秘密鍵漏洩等）で無効化された状態です。ブラウザは証明書に付随するCRL（Certificate Revocation List, 失効リスト）やOCSP（Online Certificate Status Protocol）といった仕組みを用いて、その証明書のシリアル番号が失効リストに載っていないかを確認します ([ブラウザと証明書の検証 - SSL.com](https://www.ssl.com/ja/%E8%A8%98%E4%BA%8B/%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%A8%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E6%A4%9C%E8%A8%BC/#:~:text=1,%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%AF%E7%99%BA%E8%A1%8C%E8%80%85%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%97%E3%81%BE%E3%81%99))。一般的なブラウザではOS組み込みの失効リストやオンラインのOCSPレスポンスを参照し、失効が判明した証明書であれば警告を出して接続を中止します。これら**署名の検証**・**有効期限の確認**・**失効確認**・**ドメイン名の一致確認** ([SSL 証明書とは? - SSL/TLS 証明書の説明 - AWS](https://aws.amazon.com/jp/what-is/ssl-certificate/#:~:text=4,%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AF%E3%80%81%E7%A7%98%E5%AF%86%E9%8D%B5%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E9%8D%B5%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%E6%AC%A1%E3%81%AB%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%AD%E3%83%BC%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E7%A2%BA%E8%AA%8D%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%AB%E9%80%81%E4%BF%A1%E3%81%97%E3%81%BE%E3%81%99%E3%80%82))といったチェック全てをクリアした場合にのみ、証明書は「有効なもの」とみなされます。例えばAWSの解説によれば、ブラウザは証明書の検証に成功すると、サーバ証明書の公開鍵でプレマスターシークレットを暗号化して送信し、安全なセッション鍵を共有する段階へ進みます ([SSL 証明書とは? - SSL/TLS 証明書の説明 - AWS](https://aws.amazon.com/jp/what-is/ssl-certificate/#:~:text=match%20at%20L239%204,Web%20%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AF%E3%80%81%E7%A7%98%E5%AF%86%E9%8D%B5%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E9%8D%B5%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%E6%AC%A1%E3%81%AB%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%AD%E3%83%BC%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E7%A2%BA%E8%AA%8D%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%AB%E9%80%81%E4%BF%A1%E3%81%97%E3%81%BE%E3%81%99%E3%80%82))。逆にいずれかの検証が失敗すれば、その証明書は信頼されずTLSハンドシェイク自体が失敗します。

**中間CAの役割と運用**: なぜルートCAから直接サーバ証明書を発行しないのでしょうか？　その理由はセキュリティと運用効率の両面にあります。ルートCAの秘密鍵はPKI全体の根幹であり厳重に保護する必要があります。万一流出すれば膨大な数の証明書の信頼が崩壊するため、ルート鍵はオフラインで厳重に管理されます ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=%E8%BF%99%E6%98%AF%E5%9B%A0%E4%B8%BA%E6%A0%B9%E8%AF%81%E4%B9%A6%E7%9A%84%E7%A7%81%E9%92%A5%E5%AE%89%E5%85%A8%E6%80%A7%E8%87%B3%E5%85%B3%E9%87%8D%E8%A6%81%EF%BC%8C%E4%B8%80%E6%97%A6%E8%A2%AB%E6%B3%84%E9%9C%B2%EF%BC%8C%E5%B0%86%E5%BC%95%E8%B5%B7%E5%B7%A8%E5%A4%A7%E7%9A%84%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98%E3%80%82))。そのためルート鍵で日常的に大量の証明書発行を行うのは非現実的です ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=%E6%89%80%E4%BB%A5%EF%BC%8C%E6%A0%B9%E8%AF%81%E4%B9%A6%E7%9A%84%E7%A7%81%E9%92%A5%E9%83%BD%E6%98%AF%E8%A2%AB%E4%BF%9D%E5%AD%98%E5%9C%A8%E7%A6%BB%E7%BA%BF%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%AD%EF%BC%8C%E6%9C%89%E4%B8%A5%E6%A0%BC%E7%9A%84%E6%93%8D%E4%BD%9C%E8%A7%84%E7%AB%A0%EF%BC%8C%E6%AF%8F%E6%AC%A1%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8%E6%97%B6%EF%BC%8C%E4%BC%9A%E6%9C%89%E4%B8%93%E4%BA%BA%E5%B0%86%E6%95%B0%E6%8D%AE%E9%80%9A%E8%BF%87%20USB%20%E6%8B%B7%E8%B4%9D%E8%BF%87%E5%8E%BB%EF%BC%8C%E6%93%8D%E4%BD%9C%E5%AE%8C%E4%BA%86%E4%BB%A5%E5%90%8E%EF%BC%8C%E5%86%8D%E5%B0%86%E6%95%B0%E6%8D%AE%E5%B8%A6%E5%87%BA%E6%9D%A5%E3%80%82))。そこで、ルートCAは自らの鍵で少数の中間CA証明書に署名し、中間CAがエンドエンティティ証明書を大量発行できるよう委任します ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=%E5%9C%A8%E8%BF%99%E5%A5%97%E6%B5%81%E7%A8%8B%E4%B8%8B%EF%BC%8C%E7%9B%B4%E6%8E%A5%E5%B0%86%E6%A0%B9%E8%AF%81%E4%B9%A6%E7%94%A8%E4%BA%8E%E7%AD%BE%E5%8F%91%E6%99%AE%E9%80%9A%E8%AF%81%E4%B9%A6%E6%98%AF%E4%B8%8D%E7%8E%B0%E5%AE%9E%E7%9A%84%E3%80%82%E6%83%B3%E6%83%B3%E8%BF%99%E4%B8%AA%E4%B8%96%E7%95%8C%E4%B8%8A%E6%9C%89%E5%A4%9A%E5%B0%91%E7%BD%91%E7%AB%99%EF%BC%8C%E6%AF%8F%E5%A4%A9%E5%AF%B9%E8%AF%81%E4%B9%A6%E7%9A%84%E9%9C%80%E6%B1%82%E9%87%8F%E9%83%BD%E6%98%AF%E5%B7%A8%E5%A4%A7%E7%9A%84%EF%BC%8C%E6%A0%B9%E8%AF%81%E4%B9%A6%E7%9A%84%E6%93%8D%E4%BD%9C%E6%95%88%E7%8E%87%E6%97%A0%E6%B3%95%E6%BB%A1%E8%B6%B3%E8%A6%81%E6%B1%82%EF%BC%8C%E5%9B%A0%E4%B8%BA%E4%B8%8D%E8%83%BD%E6%89%B9%E9%87%8F%E5%92%8C%E8%87%AA%E5%8A%A8%E5%8C%96%20%E3%80%82))。中間CAはオンラインで運用され自動化発行にも対応できます。また仮に中間CAの秘密鍵が漏洩しても、ルートCAから当該中間CA証明書を失効させれば被害を食い止められます ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=%E5%90%8C%E6%97%B6%EF%BC%8C%E5%AF%B9%E6%A0%B9%E8%AF%81%E4%B9%A6%E7%A7%81%E9%92%A5%E7%9A%84%E6%93%8D%E4%BD%9C%E8%B6%8A%E5%A4%9A%EF%BC%8C%E6%B3%84%E9%9C%B2%E7%9A%84%E9%A3%8E%E9%99%A9%E4%B9%9F%E5%B0%B1%E8%B6%8A%E5%A4%A7%EF%BC%8C%E5%9B%A0%E6%AD%A4%EF%BC%8C%E4%BA%BA%E4%BB%AC%E5%B0%B1%E5%8F%91%E6%98%8E%E4%BA%86%E4%B8%AD%E9%97%B4%E8%AF%81%E4%B9%A6%E3%80%82))。このように**中間CAを階層化**することで、セキュリティと利便性を両立させているのです ([What is Certificate chain? And how to validate Certificate chain | by Shanaka Sandanayaka | Medium](https://shagihan.medium.com/what-is-certificate-chain-and-how-to-verify-them-be429a030887#:~:text=Distributed%20trust%20model))。

最後に、証明書には信頼のレベルや用途に応じて種類が存在する点にも触れておきます。公開Webサーバ向けのTLS証明書には、大きくドメイン認証(DV)、実在認証(OV)、EV(Extended Validation)証明書の種類があります ([What Is an SSL Certificate Chain & How Does It Work? - InfoSec Insights](https://sectigostore.com/blog/what-is-an-ssl-certificate-chain-how-does-it-work/#:~:text=If%20you%20click%20on%20the,US))。DV証明書はドメインの所有確認のみで発行され、ブラウザ表示は錠前マークのみですが、OVやEV証明書では組織の実在性まで認証され証明書に企業名などが記載されます ([What Is an SSL Certificate Chain & How Does It Work? - InfoSec Insights](https://sectigostore.com/blog/what-is-an-ssl-certificate-chain-how-does-it-work/#:~:text=If%20you%20click%20on%20the,US))。EV証明書ではアドレスバーに企業名が表示される（一部ブラウザのみ）など信頼性のアピール方法が異なりますが、暗号強度自体が変わるわけではありません。いずれの証明書も上記のチェーン検証プロセスにより信頼性が確認されます。

以上、TLSにおける証明書システムについて、その仕組みと検証方法を詳述しました。要点をまとめると、サーバ証明書単体ではなく**認証局の階層的な信頼チェーン**によってサーバの公開鍵に対する信頼が保証されており、クライアントはこのチェーンの検証と各種チェックを行うことで安全な通信相手であると認証しています。これらフェーズ3およびフェーズ4の知識は、次の段階で扱う「SSLピンニング」の理解に向けた基盤となります。証明書システムに基づく通常の認証プロセスを踏まえた上で、ピンニングによるセキュリティ強化手法について学んでいきましょう。

**参考文献**（抜粋）：

- Cloudflare, *"What happens in a TLS handshake?"* ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=1,the%20server%20is%20who%20it)) ([What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/#:~:text=4,message%20that%20is%20encrypted))  
- CJ Ting, 「安全背后: 浏览器是如何校验证书的」 ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=,%E5%B0%86%E8%AF%A5%E3%80%8C%E7%AD%BE%E5%90%8D%E3%80%8D%E9%99%84%E5%9C%A8%20B%20%E8%AF%81%E4%B9%A6%E4%B8%AD)) ([安全背后: 浏览器是如何校验证书的 | CJ Ting's blog](https://cjting.me/2021/03/02/how-to-validate-tls-certificate/#:~:text=%E8%BF%99%E6%98%AF%E5%9B%A0%E4%B8%BA%E6%A0%B9%E8%AF%81%E4%B9%A6%E7%9A%84%E7%A7%81%E9%92%A5%E5%AE%89%E5%85%A8%E6%80%A7%E8%87%B3%E5%85%B3%E9%87%8D%E8%A6%81%EF%BC%8C%E4%B8%80%E6%97%A6%E8%A2%AB%E6%B3%84%E9%9C%B2%EF%BC%8C%E5%B0%86%E5%BC%95%E8%B5%B7%E5%B7%A8%E5%A4%A7%E7%9A%84%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98%E3%80%82))  
- Qiita (@ikiat4), 「信頼チェーンとは」 ([信頼チェーンとは #SSL証明書 - Qiita](https://qiita.com/ikiat4/items/1292608ddf5f4bbc7f0a#:~:text=%E4%B8%8A%E8%A8%98%E3%81%8C%E3%80%81%E3%82%B5%E3%83%BC%E3%83%90%E8%A8%BC%E6%98%8E%E6%9B%B8%28qiita,%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE%E3%81%A7%E3%81%99%E3%80%82%20B%E3%81%95%E3%82%93%E3%81%AE%E5%85%AC%E9%96%8B%E9%8D%B5%E3%81%A7%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%81%9F%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%81%A8C%E3%81%95%E3%82%93%E3%81%AE%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E5%80%A4%E3%82%92%E6%AF%94%E8%BC%83%E3%81%97%E3%81%A6%E6%AD%A3%E5%BD%93%E6%80%A7%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%82%92%E8%A1%8C%E3%81%84%E3%81%BE%E3%81%99%E3%80%82))  
- AWS, *"SSL/TLS 証明書はどのように機能しますか?"* ([SSL 証明書とは? - SSL/TLS 証明書の説明 - AWS](https://aws.amazon.com/jp/what-is/ssl-certificate/#:~:text=4,%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AF%E3%80%81%E7%A7%98%E5%AF%86%E9%8D%B5%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E5%BE%A9%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E9%8D%B5%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%E6%AC%A1%E3%81%AB%E3%80%81%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%AD%E3%83%BC%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E6%9A%97%E5%8F%B7%E5%8C%96%E3%81%97%E3%80%81%E7%A2%BA%E8%AA%8D%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%AB%E9%80%81%E4%BF%A1%E3%81%97%E3%81%BE%E3%81%99%E3%80%82))他  
- Future Architects 技術ブログ「HTTPS通信の中身を見て理解する（理論編・実践編）」 ([〖実践編〗HTTPS通信の中身を見て、どのようにしてセキュアな通信が確立されるかを理解する | フューチャー技術ブログ](https://future-architect.github.io/articles/20250325a/#:~:text=TLS1)) 등. (その他、本文中に示した文献箇所)